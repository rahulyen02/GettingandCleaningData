---
title: "Code Book"
output: 
  html_document:
    keep_md: true
---

### This code book details Identifiers, Measurements and Results generated from the dataset provided

```{r Main, echo=FALSE, cache=TRUE}
library(reshape2)

# Sourcing the labels and features data from the working directory to R
activity_labels <- as.character(read.table("activity_labels.txt")$V2)
features <- as.character(read.table("features.txt")$V2)

# Extracting the features on mean and standard Deviation
meanstd_features <- grep(".*mean.*|.*std.*", features)
meanstd_features.names <- features[meanstd_features]
meanstd_features.names <- gsub("-mean", "Mean", meanstd_features.names)
meanstd_features.names <- gsub("-std", "Std", meanstd_features.names)
meanstd_features.names <- gsub("[-()]", "", meanstd_features.names)

# Getting the training data into R from the working directory
train_X <- read.table("train/X_train.txt")
train_subject <- read.table("train/subject_train.txt")
train_Y <- read.table("train/Y_train.txt")
train_data <- cbind(train_subject, train_Y, train_X)

# Getting the test data into R from the working directory
test_X <- read.table("test/X_test.txt")
test_subject <- read.table("test/subject_test.txt")
test_Y <- read.table("test/Y_test.txt")
test_data <- cbind(test_subject, test_Y, test_X)

# Combining the train and test data
cons_data <- rbind(train_data, test_data)
colnames(cons_data) <- c("Subject", "Activity", meanstd_features.names)

cons_data$Activity <- factor(cons_data$Activity, levels = 1:6, labels = activity_labels)
cons_data$Subject <- as.factor(cons_data$Subject)

# Transforming the data into a lean table with Subject and Activity data as individual columns and all other columns under variable
cons_data_melt <- melt(cons_data, id = c("Subject", "Activity"))

# Calculating the mean
cons_data_mean <- dcast(cons_data_melt, Subject + Activity ~ variable, mean)

# Output is a tidy data in text format
#write.table(cons_data_mean, "tidy.txt", row.names = FALSE, quote = FALSE)
```

## Identifiers
* __`r colnames(cons_data)[1]`__: Test Subject's ID
* __`r colnames(cons_data)[2]`__: Type of activity performed by the subject when the measurements were taken
     + __`r activity_labels[1]`__: Subject was walking during the measurement
     + __`r activity_labels[2]`__: Subject was walking upstairs during the measurement
     + __`r activity_labels[3]`__: Subject was walking downstairs during the measurement
     + __`r activity_labels[4]`__: Subject was sitting during the measurement
     + __`r activity_labels[5]`__: Subject was standing during the measurement
     + __`r activity_labels[6]`__: Subject was laying down during the measurement
     
## Measurements
### The measurements recorded are listed below:
```{r Measurements, echo=FALSE, results=TRUE}
library(pander)
pandoc.list(colnames(cons_data)[3:81], style = "ordered", add.end.of.list = FALSE, add.line.breaks = FALSE)
```

## Summary of Results
### A snapshot of the output generated by the code is shown below:
```{r Summary, echo=FALSE}
summary(cons_data_mean)
```